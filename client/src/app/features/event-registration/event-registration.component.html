<div class="min-h-screen bg-base-200 py-8 px-4">
  <div class="max-w-lg mx-auto">
    
    <div class="text-center mb-6">
      <h1 class="text-3xl font-bold text-base-content mb-2">Inscripción a Evento</h1>
      <p class="text-base-content/60">Completa tus datos para registrarte</p>
    </div>

    <div class="card bg-base-100 shadow-xl">
      <div class="card-body">
        
        <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
          
          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text font-medium">Evento <span class="text-error">*</span></span>
            </label>
            <select 
              formControlName="eventId" 
              class="select select-bordered w-full"
              [class.select-error]="f['eventId'].touched && f['eventId'].invalid"
            >
              <option value="" disabled>Selecciona un evento</option>
              <option *ngFor="let event of events" [value]="event.id">
                {{ event.title }} - {{ event.eventDate | date:'dd/MM/yyyy' }} - {{ event.price | currency:'COP':'symbol':'1.0-0' }}
              </option>
            </select>
            <label class="label" *ngIf="f['eventId'].touched && f['eventId'].invalid">
              <span class="label-text-alt text-error">Debes seleccionar un evento</span>
            </label>
          </div>

          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text font-medium">Nombre Completo <span class="text-error">*</span></span>
            </label>
            <input 
              type="text" 
              placeholder="Ingresa tu nombre completo"
              formControlName="name" 
              class="input input-bordered w-full"
              [class.input-error]="f['name'].touched && f['name'].invalid"
            >
            <label class="label" *ngIf="f['name'].touched && f['name'].invalid">
              <span class="label-text-alt text-error">El nombre es requerido (mínimo 3 caracteres)</span>
            </label>
          </div>

          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text font-medium">Correo Electrónico <span class="text-error">*</span></span>
            </label>
            <input 
              type="email" 
              placeholder="ejemplo@correo.com"
              formControlName="email" 
              class="input input-bordered w-full"
              [class.input-error]="f['email'].touched && f['email'].invalid"
            >
            <label class="label" *ngIf="f['email'].touched && f['email'].invalid">
              <span class="label-text-alt text-error">Ingresa un correo válido</span>
            </label>
          </div>

          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text font-medium">Teléfono</span>
            </label>
            <input 
              type="tel" 
              placeholder="Ej: 3001234567"
              formControlName="phone" 
              class="input input-bordered w-full"
            >
          </div>

          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text font-medium">Fecha de Nacimiento <span class="text-error">*</span></span>
            </label>
            <input 
              type="date" 
              formControlName="dateBorn" 
              class="input input-bordered w-full"
              [class.input-error]="f['dateBorn'].touched && f['dateBorn'].invalid"
            >
            <label class="label" *ngIf="f['dateBorn'].touched && f['dateBorn'].invalid">
              <span class="label-text-alt text-error">La fecha de nacimiento es requerida</span>
            </label>
          </div>

          <div class="form-control mb-4">
            <label class="label cursor-pointer justify-start gap-3">
              <input 
                type="checkbox" 
                formControlName="hasSiblings" 
                class="checkbox checkbox-primary"
              >
              <span class="label-text">¿Va a inscribir a su hermano/a también? (Descuento de $10,000)</span>
            </label>
          </div>

          <!-- Precio calculado -->
          <div class="alert alert-info mb-4" *ngIf="getSelectedEvent()">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <div>
              <span class="font-medium">Precio a pagar: </span>
              <span class="font-bold">{{ getCalculatedPrice() | currency:'COP':'symbol':'1.0-0' }}</span>
              <span *ngIf="registrationForm.get('hasSiblings')?.value" class="text-sm ml-2">(Descuento hermanos aplicado)</span>
            </div>
          </div>

          <div class="divider"></div>

          <div class="alert alert-success mb-4" *ngIf="successMessage">
            <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <span>{{ successMessage }}</span>
          </div>

          <div class="alert alert-error mb-4" *ngIf="errorMessage">
            <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <span>{{ errorMessage }}</span>
          </div>

          <div class="card-actions justify-end gap-2 mt-6">
            <button 
              type="button" 
              class="btn btn-ghost"
              (click)="resetForm()"
              [disabled]="loading"
            >
              Limpiar
            </button>
            <button 
              type="submit" 
              class="btn btn-primary"
              [disabled]="loading"
            >
              <span *ngIf="loading" class="loading loading-spinner loading-sm"></span>
              <span *ngIf="!loading">Registrarse</span>
            </button>
          </div>

        </form>

      </div>
    </div>

  </div>
</div>
